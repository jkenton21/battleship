(()=>{"use strict";const e=(()=>{const e=[];return{storePlayer:t=>{e.push(t)},getPlayers:()=>e,clearPlayers:()=>{for(;e.length>0;)e.pop()}}})(),t=(()=>{const e=[],t=[];return{storeCoords:(t,n)=>{let r=a(t,n);e.push(r)},getCoords:()=>e,clearCoords:()=>{for(;e.length>0;)e.pop();for(;t.length>0;)t.pop()},storeOrientation:e=>{t.push(e)},getOrientations:()=>t}})(),n=function(){const e=document.querySelector("#main"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),a=document.createElement("span"),d=document.createElement("span"),h=document.createElement("button"),f=document.createElement("button"),p=document.createElement("div"),m=document.createElement("div"),v=document.querySelector("h2");t.setAttribute("id","placement-board"),r.setAttribute("id","board"),o.setAttribute("id","placement-options"),d.setAttribute("id","ship-name"),h.setAttribute("id","rotate-button"),f.setAttribute("id","reset-button"),n.classList.add("horiz-flex-div"),s.classList.add("vert-flex-div"),p.classList.add("row"),m.classList.add("coord-square"),h.classList.add("horizontal"),a.textContent="Place ",d.textContent="Carrier",h.textContent="Rotate Ship",f.textContent="Reset Ships",v.textContent="Human vs AI",v.style.color="black",e.appendChild(t),t.appendChild(n),n.appendChild(r),n.appendChild(o),o.appendChild(s),s.appendChild(c),c.appendChild(a),c.appendChild(d),s.appendChild(h),s.appendChild(f),p.appendChild(m),r.appendChild(p);for(let e=0;e<10;e++){const t=["A","B","C","D","E","F","G","H","I","J"];let n=document.createElement("div");n.classList.add("row"),r.appendChild(n);for(let r=0;r<10;r++){if(0===r){let r=document.createElement("div"),o=document.createElement("div");r.classList.add("coord-square"),o.classList.add("coord-square"),r.textContent=`${t[e]}`,o.textContent=`${e+1}`,n.appendChild(r),p.appendChild(o)}let o=document.createElement("div");o.classList.add("square"),o.setAttribute("id",`sq${e}${r}`),o.addEventListener("mouseover",l),o.addEventListener("mouseout",i),o.addEventListener("click",u),n.appendChild(o)}}},r=function(){const e=document.querySelector("#rotate-button"),o=document.querySelector("#reset-button");e.addEventListener("click",(()=>{e.classList.contains("horizontal")?(e.classList.remove("horizontal"),e.classList.add("vertical")):(e.classList.remove("vertical"),e.classList.add("horizontal"))})),o.addEventListener("click",(()=>{const e=document.querySelector("#main"),o=document.querySelector("#ship-name");for(;e.lastChild;)e.removeChild(e.lastChild);n(),r(),o.textContent="Carrier",t.clearCoords()}))};function o(){const e=document.querySelector("#ship-name").textContent;return"Carrier"===e?5:"Battleship"===e?4:"Destroyer"===e?3:"Submarine"===e||"Torpedo Boat"===e?2:1}function s(){const e=document.querySelector("#rotate-button");return e.classList.contains("horizontal")?"horizontal":e.classList.contains("vertical")?"vertical":void 0}function l(e){let t;t="object"==typeof e?this.id:e;let n=parseInt(t[2]),r=parseInt(t[3]),l=o();if(1===l)return;let i=document.querySelector("#rotate-button");if(i.classList.contains("horizontal")){let e;e=c(o(),n,r,s())?"darkseagreen":"mistyrose";for(let t=r;t<r+l&&t<10;t++)document.querySelector(`#sq${n}${t}`).style["background-color"]=e}else if(i.classList.contains("vertical")){let e;e=c(o(),n,r,s())?"darkseagreen":"mistyrose";for(let t=n;t<n+l&&t<10;t++)document.querySelector(`#sq${t}${r}`).style["background-color"]=e}}function i(){let e=this.id,t=parseInt(e[2]),n=parseInt(e[3]),r=o(),l=(document.querySelector("#rotate-button"),s());if("horizontal"===l)for(let e=n;e<n+r;e++){let n=document.querySelector(`#sq${t}${e}`);if(null===n)return;n.classList.contains("ship-square")?n.style["background-color"]="dimgrey":n.style["background-color"]="darkolivegreen"}else if("vertical"===l)for(let e=t;e<t+r&&e<10;e++){let t=document.querySelector(`#sq${e}${n}`);t.classList.contains("ship-square")?t.style["background-color"]="dimgrey":t.style["background-color"]="darkolivegreen"}}function c(e,t,n,r){if("horizontal"===r){if(n+e-1>=10)return!1;for(let r=n;r<n+e;r++)if(document.querySelector(`#sq${t}${r}`).classList.contains("ship-square"))return!1}if("vertical"===r){if(t+e-1>=10)return!1;for(let r=t;r<t+e;r++)if(document.querySelector(`#sq${r}${n}`).classList.contains("ship-square"))return!1}return!0}function a(e,t){return[["A","B","C","D","E","F","G","H","I","J"][e],t+1]}function u(){const n=this.id;let r=parseInt(n[2]),i=parseInt(n[3]);if(!c(o(),r,i,s()))return;if(5===t.getCoords().length)return;document.querySelector("#ship-name").textContent=function(){const e=document.querySelector("#ship-name").textContent;return"Carrier"===e?"Battleship":"Battleship"===e?"Destroyer":"Destroyer"===e?"Submarine":"Submarine"===e?"Torpedo Boat":"Torpedo Boat"===e?null:void 0}();const a=document.querySelectorAll(".square");for(let e=0;e<a.length;e++)"darkseagreen"===a[e].style["background-color"]&&(a[e].classList.remove("square"),a[e].classList.add("ship-square"),a[e].style["background-color"]="dimgrey");const u=document.querySelectorAll(".square");for(let e=0;e<u.length;e++)u[e].style["background-color"]="darkolivegreen";l(this.id),t.storeCoords(r,i),t.storeOrientation(s()),5===t.getCoords().length&&function(){let n=function(){const e=[5,4,3,2,2],n=t.getCoords(),r=t.getOrientations(),o=L("human");for(let t=0;t<n.length;t++)o.storeShip(e[t],n[t],r[t]);return o}(),r=function(){const e=L("computer");return e.AIGenPlacements(),e}();e.storePlayer(n),e.storePlayer(r),v(),C(),g(n.getNumericalShipCoords())}()}const d=function(e){const t=document.querySelector(`#${e}`);t.classList.remove("hover-square"),t.classList.remove("square"),t.classList.add("hit-square")},h=function(e){const t=document.querySelector(`#${e}`);t.classList.remove("hover-square"),t.classList.remove("square"),t.classList.add("miss-square")},f=function(e){return!!e.getFleetStatus()},p=function(t){const n=t.getName(),r=document.querySelector("h2");"computer"===n?(r.textContent="Human Wins",r.style.color="mediumblue"):(r.textContent="AI Wins",r.style.color="darkred"),function(e){const t=document.querySelectorAll(".square");for(let e=0;e<t.length;e++)t[e].removeEventListener("mouseover",l),t[e].removeEventListener("mouseout",i),t[e].removeEventListener("click",m),t[e].classList.remove("square"),t[e].classList.add("square-no-hover")}(),document.querySelector("#replay").style.display="inline",e.clearPlayers()},m=function(){let t=a(parseInt(this.id[2],10),parseInt(this.id[3],10));const n=e.getPlayers()[1];if(void 0===n)return;let r=n.receiveHit(t);if(!0===r)return d(this.id),void(f(n)&&p(n));!1===r&&(h(this.id),function(){const t=e.getPlayers()[1],n=e.getPlayers()[0],r=t.AIGetFollowupsLength();for(;;){let e,o,s,l;if(0===r?(e=t.AIGenValidMove(),l=y(e),s=`pl${l[0]}${l[1]}`,o=n.receiveHit(e),t.logPlayerAttack(e)):(l=t.AIPopFollowups(),e=a(l[0],l[1]),s=`pl${l[0]}${l[1]}`,o=n.receiveHit(e),t.logPlayerAttack(e)),!0===o){if(d(s),f(n)){p(n);break}t.AIGenFollowupAttacks(l)}if(!1===o){h(s);break}}}())},v=function(){const e=document.querySelector("#main"),t=document.querySelector("#placement-board");null!==t&&e.removeChild(t)},g=function(e){for(let t=0;t<e.length;t++){let n=e[t][0],r=e[t][1],o=document.querySelector(`#pl${n}${r}`);o.classList.remove("square"),o.classList.add("ship-square")}},C=function(){const e=document.querySelector("#main"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),s=document.createElement("div"),l=document.createElement("h3"),i=document.createElement("h3");t.setAttribute("id","game-div"),o.setAttribute("id","player"),s.setAttribute("id","computer"),o.classList.add("player-div"),s.classList.add("player-div"),n.setAttribute("id","true-p-board"),r.setAttribute("id","true-c-board"),n.classList.add("true-board"),r.classList.add("true-board"),l.textContent="Player",i.textContent="Computer",e.appendChild(t),t.appendChild(o),o.appendChild(l),o.appendChild(n),t.appendChild(s),s.appendChild(i),s.appendChild(r),function(){const e=document.querySelector("#true-p-board"),t=document.createElement("div"),n=document.createElement("div"),r=document.querySelector("#true-c-board"),o=document.createElement("div"),s=document.createElement("div");t.classList.add("row"),n.classList.add("coord-square"),o.classList.add("row"),s.classList.add("coord-square"),t.appendChild(n),o.appendChild(s),e.appendChild(t);for(let n=0;n<10;n++){const r=["A","B","C","D","E","F","G","H","I","J"];let o=document.createElement("div");o.classList.add("row"),e.appendChild(o);for(let e=0;e<10;e++){if(0===e){let e=document.createElement("div"),s=document.createElement("div");e.classList.add("coord-square"),s.classList.add("coord-square"),e.textContent=`${r[n]}`,s.textContent=`${n+1}`,o.appendChild(e),t.appendChild(s)}let s=document.createElement("div");s.classList.add("square"),s.setAttribute("id",`pl${n}${e}`),o.appendChild(s)}}r.appendChild(o);for(let e=0;e<10;e++){const t=["A","B","C","D","E","F","G","H","I","J"];let n=document.createElement("div");n.classList.add("row"),r.appendChild(n);for(let r=0;r<10;r++){if(0===r){let r=document.createElement("div"),s=document.createElement("div");r.classList.add("coord-square"),s.classList.add("coord-square"),r.textContent=`${t[e]}`,s.textContent=`${e+1}`,n.appendChild(r),o.appendChild(s)}let s=document.createElement("div");s.classList.add("square"),s.setAttribute("id",`co${e}${r}`),s.addEventListener("mouseover",(()=>{s.classList.contains("square")&&(s.classList.remove("square"),s.classList.add("hover-square"))})),s.addEventListener("mouseout",(()=>{s.classList.contains("hover-square")&&(s.classList.remove("hover-square"),s.classList.add("square"))})),s.addEventListener("click",m),n.appendChild(s)}}}()},y=function(e){let t=e[0];return[["A","B","C","D","E","F","G","H","I","J"].indexOf(t),e[1]-1]};function q(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const L=function(e){const t=e,n=[],r=(()=>{const e=[],t=[],n=[],r=function(e){for(let t=0;t<n.length;t++)if(q(n[t],e))return!0;return!1};return{placeShip:function(t,n,r){const o=function(e,t,n){let r=[t];if("horizontal"===n){if(t[1]+e-1>10)return null;for(let n=1;n<e;n++)r.push([t[0],t[1]+n])}else{const n=t[0].charCodeAt();if(n+e-1>74)return null;for(let o=1;o<e;o++)r.push([String.fromCharCode(n+o),t[1]])}return r}(t.getLength(),n,r),s={ship:t,coords:o};e.push(s)},checkFleetSunk:()=>{if(0===e.length)return null;for(let t=0;t<e.length;t++)if(!1===e[t].ship.getSunkStatus())return!1;return!0},checkHit:function(o){for(let t=0;t<e.length;t++)for(let l=0;l<e[t].coords.length;l++)if(q(e[t].coords[l],o))return r(o)?null:(e[t].ship.hit(l),s=o,n.push(s),!0);var s,l;return function(e){for(let n=0;n<t.length;n++)if(q(t[n],e))return!0;return!1}(o)?null:(l=o,t.push(l),!1)},checkMisses:function(){return t},getShips:function(){return e},checkHits:function(){return n}}})(),o=[],s=function(e,t,n){r.placeShip((e=>{if(e<2||e>5||void 0===e)return null;const t=[],n=e;let r=!1;for(let e=0;e<n;e++)t.push(!1);return{getLength:function(){return n},getHitStatus:function(){return t},getSunkStatus:function(){return r},hit:function(e){t[e]=!0,-1===t.indexOf(!1)&&(r=!0)}}})(e),t,n)},l=function(){return[["A","B","C","D","E","F","G","H","I","J"][Math.floor(10*Math.random())],Math.floor(10*Math.random())+1]},i=function(e){for(let t=0;t<n.length;t++)if(q(n[t],e))return!1;return!0},c=function(e){const t=e[0],r=e[1],o=a(t,r);if(t>9||t<0||r>9||r<0)return!1;for(let e=0;e<n.length;e++)if(q(n[e],o))return!1;return!0},u=function(e,t){for(let n=0;n<e.length;n++)if(q(e[n],t))return n;return-1},d=function(){const e=function(){const e=[];for(let t=0;t<10;t++)for(let n=0;n<10;n++)e.push([t,n]);return e}(),t=r.getShips();for(let n=0;n<t.length;n++){let r=t[n].coords;for(let t=0;t<r.length;t++){let n=y(r[t]),o=u(e,n);-1!==o&&(e[o]=[null])}}return e},h=function(e,t,n,r){const o=[];if("horizontal"===r){if(n+e-1>9)return!1;for(let r=0;r<e;r++)o.push([t,n+r])}if("vertical"===r){if(t+e-1>9)return!1;for(let r=0;r<e;r++)o.push([t+r,n])}return o},f=function(e,t){for(let n=0;n<t.length;n++){let r=!1;for(let o=0;o<e.length;o++)q(t[n],e[o])&&(r=!0);if(!1===r)return!1}return!0};return{getName:function(){return t},getHitsMadeByThisPlayer:function(){return n},storeShip:s,receiveHit:function(e){return r.checkHit(e)},logPlayerAttack:function(e){n.push(e)},getFleetStatus:function(){return r.checkFleetSunk()},getPlayerMisses:function(){return r.checkMisses()},checkLegalMove:i,AIGenValidMove:function(){let e=l();for(;!i(e);)e=l();return e},debugGetBoard:function(){return r},AIGenPlacements:function(){const e=[5,4,3,2,2];for(let t=0;t<5;t++){let n,r,o=e[t];for(;;){let e=[Math.floor(10*Math.random()),Math.floor(10*Math.random()),["horizontal","vertical"][Math.floor(2*Math.random())]],t=e[0],s=e[1];if(r=e[2],n=h(o,t,s,r),!1!==n)break}let l=d();if(f(l,n)){let e=a(n[0][0],n[0][1]);s(o,e,r)}else t--}},testAIGenPlacements:function(){const e=[5,4,3,2,2],t=r.getShips().length;if(5!==t)return!1;const n=r.getShips();for(let r=0;r<t;r++)if(n[r].ship.getLength()!==e[r])return!1;let o=0;for(let e=0;e<t;e++)o+=n[e].coords.length;if(16!==o)return!1;const s=[];for(let e=0;e<t;e++)for(let t=0;t<n[e].coords.length;t++)s.push(n[e].coords[t]);for(let e=0;e<s.length;e++){let t=0;for(let n=0;n<s.length;n++)q(s[e],s[n])&&t++;if(1!==t)return!1}const l=["A","B","C","D","E","F","G","H","I","J"];for(let e=0;e<s.length;e++){let t=s[e][0],n=s[e][1];if(-1===l.indexOf(t))return!1;if(n<1||n>10)return!1}return!0},getNumericalShipCoords:function(){const e=r.getShips(),t=[];for(let n=0;n<e.length;n++){let r=e[n].coords;for(let e=0;e<r.length;e++)t.push(y(r[e]))}return t},AIGenFollowupAttacks:function(e){const t=[],n=e[0],r=e[1],s=[n-1,r],l=[n+1,r],i=[n,r-1],a=[n,r+1];c(s)&&t.push(s),c(l)&&t.push(l),c(i)&&t.push(i),c(a)&&t.push(a);for(let e=0;e<t.length;e++)o.push(t[e])},AIPopFollowups:function(){return o.pop()},AIClearFollowups:function(){for(;o.length>0;)o.pop()},AIGetFollowupsLength:function(){return o.length}}};!function(){const e=document.querySelector("#replay");e.style.display="none",e.addEventListener("click",(()=>{const o=document.querySelector("#main"),s=document.querySelector("#game-div");o.removeChild(s),n(),r(),t.clearCoords(),e.style.display="none"}))}(),n(),r()})();